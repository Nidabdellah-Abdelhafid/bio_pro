---
- name: Deploy Application to Kubernetes
  hosts: localhost
  gather_facts: false
  connection: local  # Add this line to specify local connection

  tasks:
    - name: Apply Deployment
      command: kubectl apply -f deployment.yml
      environment:
        KUBECONFIG: "{{ kubeconfig }}"
        TMPDIR: "/tmp"
      
    - name: Apply Service
      command: kubectl apply -f service.yml
      environment:
        KUBECONFIG: "{{ kubeconfig }}"
